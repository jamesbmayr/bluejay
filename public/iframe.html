<!DOCTYPE html>
<html>
	<head>
		<title>bluejay iframe</title>
	</head>
	<body>
		<script node>
			try {
				var apiResponse = request.apiResponse
				var data = {
					function: "changeConfiguration",
					input: {
						key: request.post.host,
						value: {
							access_token: apiResponse.access_token,
							token_type: apiResponse.token_type,
							expiration: new Date().getTime() + (apiResponse.expires_in * 1000),
							refresh_token: apiResponse.refresh_token,
							scope: apiResponse.scope
						}
					}
				}

				("<style>html, body, a { font-family: monospace; font-color: #222222; font-size: 20px; }</style>" +
				"<b>Success!</b>" +
				"<script>window.top.postMessage(" + JSON.stringify(data) + ")</script>")
			}
			catch (error) {
				"<b>Failure!</b><br>Please try this command again."
			}
		</script>node>
	</body>
</html>